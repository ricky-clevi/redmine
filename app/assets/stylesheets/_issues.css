/**
 * Redmine Modern UI - Issues (Phase 4)
 * 
 * Styles for issue list and issue detail views.
 */

/* ============================================
 * STATUS BADGES
 * ============================================ */

.status-badge {
  display: inline-flex;
  align-items: center;
  padding-block: var(--space-0-5);
  padding-inline: var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  line-height: var(--leading-normal);
  border-radius: var(--radius-full);
  white-space: nowrap;
}

/* Default status */
.status-badge--default {
  background: var(--color-neutral-100);
  color: var(--color-neutral-700);
}

/* New - Blue */
.status-badge--new,
.status-badge[data-status="new"] {
  background: var(--color-primary-100);
  color: var(--color-primary-700);
}

/* In Progress - Yellow */
.status-badge--in-progress,
.status-badge[data-status="in-progress"] {
  background: var(--color-warning-100);
  color: var(--color-warning-700);
}

/* Resolved - Green */
.status-badge--resolved,
.status-badge[data-status="resolved"] {
  background: var(--color-success-100);
  color: var(--color-success-700);
}

/* Closed - Gray */
.status-badge--closed,
.status-badge[data-status="closed"] {
  background: var(--color-neutral-200);
  color: var(--color-neutral-600);
}

/* Feedback - Orange */
.status-badge--feedback,
.status-badge[data-status="feedback"] {
  background: #fff4e6;
  color: #e67700;
}

/* Rejected - Red */
.status-badge--rejected,
.status-badge[data-status="rejected"] {
  background: var(--color-danger-100);
  color: var(--color-danger-700);
}

/* ============================================
 * PRIORITY BADGES
 * ============================================ */

.priority-badge {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding-block: var(--space-0-5);
  padding-inline: var(--space-2);
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  border-radius: var(--radius-md);
}

.priority-badge--low {
  background: var(--color-neutral-100);
  color: var(--color-neutral-600);
}

.priority-badge--normal {
  background: var(--color-primary-50);
  color: var(--color-primary-600);
}

.priority-badge--high {
  background: #fff9db;
  color: #f59f00;
}

.priority-badge--urgent {
  background: #ffe3e3;
  color: var(--color-danger-600);
}

.priority-badge--immediate {
  background: var(--color-danger-600);
  color: var(--color-neutral-0);
}

/* ============================================
 * ISSUE LIST TABLE
 * ============================================ */

table.list.issues {
  width: 100%;
  border-collapse: collapse;
}

table.list.issues th {
  background: var(--color-bg-secondary);
  font-weight: var(--font-medium);
  font-size: var(--text-xs);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
  color: var(--color-text-muted);
  padding: var(--space-2) var(--space-3);
  text-align: start;
  border-block-end: 2px solid var(--color-border-default);
}

table.list.issues td {
  padding: var(--space-3);
  border-block-end: 1px solid var(--color-border-subtle);
  font-size: var(--text-sm);
  vertical-align: middle;
}

table.list.issues tr:hover {
  background: var(--color-bg-hover);
}

table.list.issues tr.odd {
  background: transparent;
}

table.list.issues tr.even {
  background: transparent;
}

table.list.issues tr.odd:hover,
table.list.issues tr.even:hover {
  background: var(--color-bg-hover);
}

/* Issue ID column */
table.list.issues td.id {
  font-weight: var(--font-medium);
  white-space: nowrap;
}

table.list.issues td.id a {
  color: var(--color-text-link);
}

/* Subject column */
table.list.issues td.subject {
  max-width: 400px;
}

table.list.issues td.subject a {
  color: var(--color-text-primary);
  font-weight: var(--font-medium);
}

table.list.issues td.subject a:hover {
  color: var(--color-text-link);
}

/* Status column */
table.list.issues td.status {
  white-space: nowrap;
}

/* Priority column - color indicators */
table.list.issues tr.priority-lowest td.priority { color: var(--color-neutral-500); }
table.list.issues tr.priority-low td.priority { color: var(--color-neutral-600); }
table.list.issues tr.priority-default td.priority { color: var(--color-text-primary); }
table.list.issues tr.priority-high td.priority { color: var(--color-warning-600); font-weight: var(--font-medium); }
table.list.issues tr.priority-highest td.priority { color: var(--color-danger-600); font-weight: var(--font-semibold); }

/* Done ratio progress bar */
table.list.issues td.done_ratio {
  white-space: nowrap;
}

.progress {
  display: inline-flex;
  width: 80px;
  height: 8px;
  background: var(--color-neutral-200);
  border-radius: var(--radius-full);
  overflow: hidden;
}

.progress .closed,
.progress .done {
  background: var(--color-success-500);
  height: 100%;
}

.progress .open {
  background: var(--color-neutral-200);
  height: 100%;
}

/* ============================================
 * ISSUE LIST FILTERS
 * ============================================ */

#query_form_content,
.query-form {
  background: var(--color-bg-secondary);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  margin-block-end: var(--space-4);
}

.filter-row {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  margin-block-end: var(--space-2);
}

.filter-row label {
  min-width: 120px;
  margin-block-end: 0;
}

.filter-row select,
.filter-row input {
  flex: 1;
  max-width: 200px;
}

/* Active filters pills */
.applied-filter {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding-block: var(--space-1);
  padding-inline: var(--space-2) var(--space-1);
  background: var(--color-primary-100);
  color: var(--color-primary-700);
  border-radius: var(--radius-full);
  font-size: var(--text-xs);
  margin-inline-end: var(--space-1);
  margin-block-end: var(--space-1);
}

.applied-filter__remove {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  background: var(--color-primary-200);
  border-radius: var(--radius-full);
  color: var(--color-primary-700);
  font-size: 10px;
  cursor: pointer;
}

.applied-filter__remove:hover {
  background: var(--color-primary-300);
}

/* ============================================
 * ISSUE DETAIL VIEW
 * ============================================ */

.issue {
  margin-block-end: var(--space-6);
}

/* Issue header */
.issue h2 {
  font-size: var(--text-xl);
  font-weight: var(--font-semibold);
  margin-block-end: var(--space-4);
  display: flex;
  align-items: flex-start;
  gap: var(--space-3);
}

.issue .subject h3 {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  margin: 0;
}

/* Issue attributes */
.issue .attributes {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: var(--space-4);
  background: var(--color-bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
  margin-block-end: var(--space-4);
}

.issue .attribute {
  display: flex;
  flex-direction: column;
  gap: var(--space-1);
}

.issue .attribute .label {
  font-size: var(--text-xs);
  font-weight: var(--font-medium);
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
}

.issue .attribute .value {
  font-size: var(--text-sm);
  color: var(--color-text-primary);
}

/* Issue description */
.issue .description {
  margin-block-end: var(--space-6);
}

.issue .description .wiki {
  background: var(--color-bg-primary);
  border: 1px solid var(--color-border-subtle);
  border-radius: var(--radius-lg);
  padding: var(--space-4);
}

/* ============================================
 * ISSUE HISTORY / JOURNAL
 * ============================================ */

#history {
  margin-block-start: var(--space-6);
}

#history h3 {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  margin-block-end: var(--space-4);
  padding-block-end: var(--space-2);
  border-block-end: 1px solid var(--color-border-subtle);
}

.journal {
  position: relative;
  padding-inline-start: var(--space-12);
  padding-block: var(--space-4);
  border-block-end: 1px solid var(--color-border-subtle);
}

.journal:last-child {
  border-block-end: none;
}

/* Journal avatar placeholder */
.journal::before {
  content: "";
  position: absolute;
  inset-inline-start: 0;
  inset-block-start: var(--space-4);
  width: 32px;
  height: 32px;
  background: var(--color-neutral-200);
  border-radius: var(--radius-full);
}

.journal h4 {
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  margin: 0 0 var(--space-2);
  display: flex;
  align-items: center;
  gap: var(--space-2);
}

.journal h4 a.user {
  color: var(--color-text-primary);
  font-weight: var(--font-semibold);
}

.journal h4 .journal-link {
  color: var(--color-text-muted);
  font-weight: var(--font-normal);
}

/* Journal details (field changes) */
.journal .details {
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  margin-block-end: var(--space-2);
  padding-inline-start: 0;
}

.journal .details li {
  list-style: none;
  margin-block-end: var(--space-1);
}

.journal .details li strong {
  font-weight: var(--font-medium);
  color: var(--color-text-primary);
}

/* Journal notes (comments) */
.journal .wiki {
  background: var(--color-bg-secondary);
  border-radius: var(--radius-lg);
  padding: var(--space-3);
  margin-block-start: var(--space-2);
}

/* Private notes */
.journal.private-notes {
  background: var(--color-warning-50);
  border-radius: var(--radius-lg);
  margin-inline-start: calc(var(--space-12) * -1);
  padding-inline-start: var(--space-12);
}

/* ============================================
 * ISSUE RELATIONS
 * ============================================ */

.issue .relations {
  margin-block-end: var(--space-4);
}

.issue .relations h3 {
  font-size: var(--text-base);
  font-weight: var(--font-semibold);
  margin-block-end: var(--space-2);
}

.issue .relations table {
  width: 100%;
  margin: 0;
}

.issue .relations td {
  padding: var(--space-2);
  border: none;
}

/* ============================================
 * SUBTASKS
 * ============================================ */

.issue .subtasks {
  margin-block-end: var(--space-4);
}

.issue .subtasks h3 {
  font-size: var(--text-base);
  font-weight: var(--font-semibold);
  margin-block-end: var(--space-2);
}

.issue .subtasks table {
  width: 100%;
}

/* ============================================
 * ISSUE CONTEXTUAL ACTIONS
 * ============================================ */

.issue .contextual {
  float: right;
  display: flex;
  gap: var(--space-2);
}

.issue .contextual a {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1-5) var(--space-2);
  font-size: var(--text-sm);
  color: var(--color-text-secondary);
  border-radius: var(--radius-md);
  transition: var(--transition-colors);
}

.issue .contextual a:hover {
  background: var(--color-bg-hover);
  color: var(--color-text-primary);
  text-decoration: none;
}

/* ============================================
 * CLOSED ISSUE STYLING
 * ============================================ */

tr.closed td.subject a,
.issue.closed h3 {
  text-decoration: line-through;
  color: var(--color-text-muted);
}

tr.closed {
  opacity: 0.7;
}

tr.closed:hover {
  opacity: 1;
}
